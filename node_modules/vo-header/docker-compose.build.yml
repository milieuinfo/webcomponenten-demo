version: "3"
services:
  build:
    image: ${DOCKER_REGISTRY}node:10
    working_dir: /workdir
    volumes:
      - ${HOME:-.}/.npmrc:/root/.npmrc:ro
      - ${HOME:-.}/.gitconfig:/root/.gitconfig:ro
      - ${HOME:-.}/.git-credentials:/root/.git-credentials:ro
      - .:/data:ro
    command: bash -c "cp -R /data/. /workdir && npm install && npm run build"
